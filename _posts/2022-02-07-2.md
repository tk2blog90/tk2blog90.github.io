---
layout: post
title: 로또번호추첨기 개발기
description: 다들 대박나길 기원하는 마음으로..
subject: Dev
keywords: 로또, lotto, 복권
---

이번 포스팅은 약 이틀에 걸쳐 개발한 로또번호추첨기.
사실 기존에 개발해뒀던 로또추첨기가 있지만
마음에 들지 않아서 이번에 버전 2 라는 이름으로 다시 한 번 만들었다.

# 기존 로또 추첨기

{% capture url %}{{ "https://tk2rush90.github.io/lotto" }}{% endcapture %}
{% capture name %}{{ "로또 추첨기" }}{% endcapture %}
{% capture thumbnail %}{{ "https://tk2rush90.github.io/lotto/assets/images/banner.png" }}{% endcapture %}
{% include site-link.html %}

만든지 상당히 오래된 기존 로또 추첨기이다.

이때 당시에는 인터랙티브 디벨로퍼라는 이름으로도 유명한 김종민 개발자 분에게 꽂혀서
동적힌 화면을 구성하는데 노력을 기울였다.

하지만 최근에 다시 보니 로또 번호를 뽑거나 테스트 해보려는 사람에게
이런 인터랙션은 사실상 무의미하고, 특히 빨리빨리의 민족인 한국인에게는 진짜 추첨도 아닌데 답답함을 줄 수도 있을 것 같아서
새로 개발하기로 마음을 먹었다.

# 로또번호추첨기 ver.2

## 기술스택

- Angular 13.2.0
- NestJS 8
- Heroku
- [Cheerio](https://www.npmjs.com/package/cheerio){:target="_blank" rel="nofollow noopener noreferrer"}

## 개요

{% capture url %}{{ "https://tk2rush90.github.io/lotto-v2" }}{% endcapture %}
{% capture name %}{{ "로또번호추첨기" }}{% endcapture %}
{% capture thumbnail %}{{ "https://tk2rush90.github.io/lotto-v2/assets/images/thumbnail.png" }}{% endcapture %}
{% include site-link.html %}

기존에 만든 로또 추첨기의 단점은 인터랙션도 있었지만
데이터를 매주 내가 업로드 해줘야한다는 문제점이 있었다.
이게 바로 서버가 없기 때문에 벌어진 불상사라고 할 수 있는데 ..
이제 뭐다 ? 나에겐 서버가 생겼다~ 이 말이야 !

## 크롤링 기능

그리하여 Heroku에 열심히 돌아가고 있는 백엔드에 로또 결과 크롤링 기능을 추가했다.

처음엔 매주 토요일 저녁에 수집 기능을 돌리려다가
타임존 계산하기도 귀찮고 그 시간대에 로또 홈페이지에 업데이트가 안돼있을 경우도 고려해
매 6시간마다 수집 정보를 확인하도록 구성했다.

이 부분은 아마 좀 더 빨라질 수도 있을 것 같다.

수집된 데이터는 json 형태로 서버에 저장해뒀다가 웹페이지 로드 시 API를 호출해 데이터를 불러오도록 구성했다.

## 화면

[![img.png](/assets/images/lotto-occurrence.png)](/assets/images/lotto-occurrence.png){:target="_blank"}

로또 추첨기 PC버전 메인 화면은 이렇다.

이전보다 디자인이 훨씬 심플해졌고 한 페이지 안에서 모든 것을 다 해결할 수 있도록 해놨다.

[![img_1.png](/assets/images/lotto-results.png)](/assets/images/lotto-results.png){:target="_blank"}

좌측에서 6개의 번호를 선택하면 우측 '이전 결과 대비'에서
이전 우승 기록과 비교했을 때 현재 선택한 번호가 몇 등을 몇 회 할 수 있는지 볼 수 있다.

[![img_2.png](/assets/images/lotto-home.png)](/assets/images/lotto-home.png){:target="_blank"}

아래 '각 번호별 발생 확률'은 이전 추첨 결과를 봤을때 각 번호들이 몇 번 추첨되었는지 횟수와 발생 확률을 나타낸다.

## 자동선택

이번 개발에서 신경을 쓴 부분은 자동선택 로직인데,
기본 방식과 가중 방식을 이용해 자동으로 번호를 선택할 수 있다.

기본 방식은 모든 번호에 동일한 확률을 주는 것이다.

```
발생확률 = 1 / 45 = 0.0222...
```

간단한 방법이었기 때문에 개발에 어려움은 없었다.

정말 신경 쓴 부분은 가중 방식으로, 각 번호의 발생확률이 극한으로 수렴하면 `0.0222...`가 된다는 것을 가정하고
`0.0222...` 보다 작은 빈도로 나온 번호에 더 높은 확률을, 높은 빈도로 나온 번호에 더 낮은 확률을 부여하고 선택하도록 했다.

또한 기본과 가중 모두 한 번호가 추첨되고 나면 남은 번호들로 확률을 다시 계산해주었다.

# 마무리

이게 얼마나 큰 도움이 될 지는 모르겠고
사실 반은 재미로 만든 것도 있지만 ㅋㅋㅋ
그래도 또 반은 혹시나 하는 기대감을 가지고 만들었으니
다들 로또 사서 부자가 되어보자 !
