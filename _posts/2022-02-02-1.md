---
layout: post
title: 사천버스정보시스템 (비공식) 개발기
description: 데이터 도둑이 요기잉네?
subject: Dev
keywords: 사천버스정보시스템, 사천버스시간표, 버스시간표
---

첫 번째 포스팅은 사천버스정보시스템 개발에 관한 이야기.
블로그를 몇 번이나 갈아치우고 다시 만드는지 모르겠다.
희망하기로는 이번 지킬 블로그가 마지막이 되길 바라는데 .. 사람 일은 어떻게 될 지 알 수가 없다 ㅋㅋ

사천버스정보시스템에 대해 소개하기 전에 블로그 갈아엎기(記)에 대해 이야기 해보자면 ..
참 다양한 이유로 블로그를 갈아엎었다.

단순히 디자인 때문에 갈아엎은 것만 몇 번에, 무료 서버만 찾아다니다가 서버 성능 이슈로 인해 갈아엎기도 하고,
유료 서버를 결제하고 쓰다가 방문자도 별로 없는데 🥲 돈 나가는게 아까워서 갈아엎고 ..
제일 최근에 만든건 앵귤러 + 구글 블로거 API 기반으로 Github Pages에 호스팅 했었는데
SPA다보니 SEO가 메인페이지 말고는 하나도 안 되는 이슈가 .. 😭

그리하여 돌고돌아 도착한 것이 Jekyll theme을 이용한 지금의 블로그다.
이것저것 꾸미기도 귀찮고 그냥 제일 심플한 템플릿 하나 선택해서 간단하게 몇 가지만 좀 바꿔서 쓰는 중이다.

블로그에 대한 이야기는 다음에 다시 하기로 하고 오놀의 주제인 사천버스정보시스템에 대해 알아보자.

# 사천버스정보시스템

## 오피셜

요즘 대부분 지역은 버스정보시스템이 지도 앱들과 연동이 잘 돼있는 편이다.
대부분이라고 하는 이유는 당연히 사천은 그렇지 않기 때문 🥲

그래서 2019년에 사천버스정보시스템을 자체적으로 운영하기 시작했는데, 아래가 그 링크다.

{% capture url %}{{ "http://bus.sacheon.go.kr/main/index.asp" }}{% endcapture %}
{% capture name %}{{ "사천시 버스정보시스템" }}{% endcapture %}
{% capture thumbnail %}{{ "" }}{% endcapture %}
{% include site-link.html %}

보면 2019년에 만든 것 치고 상당히 옛스러운 UI와 불편한 UX는 덤으로, 나는 도저히 정을 붙일 수 없는 사이트였다 ㅋㅋ

그리하여 위 사이트에서 사용되고 있는 API를 훔쳐(?) 와서 좀 더 사용하기 편한 방향으로 한 번 만들어보고자
비공식 웹앱을 만들게 되었다.

## 논오피셜

### 기술 스택

- Angular 13.2.0 (프론트엔드)
- Github Pages (프론트엔드)
- NestJS 8 (백엔드)
- Heroku (백엔드)
- 카카오맵 API

### 개요

{% capture url %}{{ "https://tk2rush90.github.io/sacheon-bus" }}{% endcapture %}
{% capture name %}{{ "사천버스정보시스템" }}{% endcapture %}
{% capture thumbnail %}{{ "/assets/images/sacheon-bus.png" }}{% endcapture %}
{% include site-link.html %}

위 사이트가 논오피셜로 내가 만든 사천버스정보시스템이다.
링크 보면 알겠지만 Github Pages를 이용해서 호스팅했고, 백엔드는 Heroku의 무료 Dyno를 사용했다.

사천시청 API를 사용하는데 백엔드가 필요했던 이유는 CORS 이슈 때문에 !

사실 처음에 테스트 개발 과정에서 CORS 이슈를 접하고
무료로 프록시 서버를 돌릴 수 있는 방법이 마땅히 없어서 때려칠까 고민했는데
찾아보니 Heroku 무료 Dyno를 이용할 수 있는 방법이 있었다.

Heroku 무료 계정의 경우 신용카드 인증을 하면 한 달에 1,000시간 동안 무료로 Dyno를 실행할 수 있다.
하지만 30분 동안 요청이 없으면 앱이 슬립 상태에 들어가고
슬립 상태에서 요청 발생 시 응답 시간이 오래 걸린다는 단점이 있었는데,
이리저리 찾아본 결과 [New Relic](https://elements.heroku.com/addons/newrelic)이라는 애드온을 사용하면
일정시간마다 핑을 보내 앱을 항상 깨어있는 상태로 유지할 수 있었다.

게다가 New Relic은 Free plan까지 제공하니 무료로 돌릴 수 있는 서버가 하나 생겨난 것 !

비록 1,000시간 제한 때문에 한 가지 앱 밖에 돌릴 수 없지만
내가 하는 프로젝트가 대부분 소규모 개인 프로젝트라서 백엔드 하나로 구조만 잘 짜면 여러 프로젝트를 핸들할 수 있을 듯.

### 디자인

[![메인화면](/assets/images/sacheon-bus-main.png)](/assets/images/sacheon-bus-main.png)

그리하여 만들어진 웹앱의 메인화면이다.

위 화면은 시청앞에 도착하는 버스 정보를 검색한 결과이다.
기존의 버스정보시스템은 실시간으로 버스 조회가 안 되는 불편함이 있었기 때문에
일정 시간마다 자동으로 새로고침 되게 만들었다.

한 가지 문제점은 가끔 시청 서버가 맛탱이가 가서 데이터를 제대로 못 불러오는 경우가 있는데,
나는 데이터가 제대로 호출됐을 경우만 가정해서 새로고침 타이머가 동작하게 했기 때문에
이 부분은 수정이 필요할 듯.

어떻게 할 지는 아직 모르겠다.

그리고 검색창을 누르면,

[![정류장 검색](/assets/images/sacheon-bus-search.png)](/assets/images/sacheon-bus-map-search.png)

이렇게 정류장을 검색할 수 있는 화면이 뜬다.

메인 화면에 있던 검색창은 사실 가짜이기 때문에 여기서 검색 결과를 선택했을 때만
해당 정류장의 버스 도착 정보를 조회할 수 있다.

[![정류장 검색 - 지도](/assets/images/sacheon-bus-map-search.png)](/assets/images/sacheon-bus-map-search.png)

메인화면에서 '지도에서 검색'을 선택하면 위 화면을 볼 수 있다.
여기는 카카오맵 API를 사용했는데, 카카오맵 API가 타입스크립트를 지원하지 않아서 개발 과정이 좀 불편했다.

그래도 IT 회사인데 타입스크립트를 쓰지 않다니 ..

또 하나 애 먹었던 부분은 카카오맵은 지도 이미지에 버스 정류장 표시가 박제 돼있었던 것이다.
커스텀 아이콘을 쓰면 기존 버스 정류장 이미지랑 겹쳐서 보기 불편했는데,
이 부분은 지도 확대 레벨에 제한을 둬서 버스 정류장이 지도에 표시되지 않는 수준까지만 확대되도록 해놨다.

[![정류장 검색 - 지도 - 하이라이트](/assets/images/sacheon-bus-map-search-highlight.png)](/assets/images/sacheon-bus-map-search-highlight.png)

마지막으로 지도에서 버스 아이콘을 선택하거나 목록에서 정류장을 선택하면
위와 같이 한 번 더 탭하라는 안내와 함께 해당 정류장이 하이라이트 처리 된다.

한 번 더 탭할 경우 아까 본 메인화면으로 넘어가서 버스 도착 정보를 확인할 수 있다.

이 부분은 표시할 목록이 없을 때 '검색 결과가 없습니다' 등의 메세지를 추가해야할 듯.

### 추후 업데이트 예정

앞으로 업데이트하게 될 내용은 최근 검색 정류장 및 즐겨찾기 기능을 추가하는 것이다.
기능을 구현하는 것은 간단한데 현재 UI에서 어떻게 들어가야할 지를 고민하느라 개발이 좀 늦어질 것 같다.

그리고 이 정보는 백엔드에 저장할 것은 아니라서 브라우저가 바뀌거나 디바이스가 바뀌면 공유되지 않을 예정.

# 마무리

간단한 프로젝트였기 때문에 금방 끝이 났다.
아직 추가 개발 건이 있긴 하지만 이 정도면 잘 마무리 한 듯.
이번 프로젝트로 얻은 수확은 Heroku를 무료로 24시간 깨워둘 수 있는 방법이 있다는 걸 알게된 것 !

서버용으로 쓸 PC가 생기기 전까진 유용하게 사용할 것 같다.
